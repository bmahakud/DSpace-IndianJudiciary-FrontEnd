<!-- <div class="container p-4">
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="position-relative">
        <div class="input-group">
          <input [(ngModel)]="searchQuery" (input)="onSearchInput()" class="form-control" placeholder="Search..."
            [disabled]="loading" />
          <button (click)="searchItems()" class="btn btn-primary">
            <span *ngIf="loading" class="spinner-border spinner-border-sm me-1"></span>
            Search
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="mb-4">
    <div class="row">
      <div class="col-md-4">
        <button class="btn btn-secondary mb-3 w-100" (click)="addToCart()"
          [disabled]="selectedSearchFiles.length === 0">
          Add to Cart ({{ selectedSearchFiles.length }})
        </button>
      </div>

      <div class="col-md-4">
        <button (click)="generateFiles()" [disabled]="generating || selectedSearchFiles.length === 0"
          class="btn btn-success mb-3 w-100">
          <span *ngIf="generating" class="spinner-border spinner-border-sm me-1"></span>
          {{ generating ? 'Generating...' : 'Generate Files' }}
        </button>
      </div>

      <div class="col-md-4">
        <button (click)="submitAllFiles()" [disabled]="!selectedGeneratedFiles.length || submitting"
          class="btn btn-primary mb-3 w-100">
          <span *ngIf="submitting" class="spinner-border spinner-border-sm me-1"></span>
          {{ submitting ? 'Submitting...' : 'Post All Files' }}
        </button>
      </div>
    </div>
  </div>

  <div class="card" *ngIf="searchResults.length > 0">
    <div class="card-header">
      <h5 class="mb-0">Search Results</h5>
    </div>
    <div class="card-body">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Select</th>
            <th>CINO Number</th>
            <th>File Name</th>
            <th>Created At</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let file of searchResults">
            <td>
              <input type="checkbox" [(ngModel)]="file.selected" (change)="onSearchSelectionChange()" />
            </td>
            <td>{{ file.cino }}</td>
            <td>{{ file.fileName }}</td>
            <td>{{ file.createdAt | date:'short' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="searchResults.length === 0 && searchQuery" class="text-center text-muted py-4">
    No records found for "{{ searchQuery }}".
  </div>

  <div class="card" *ngIf="generatedFiles.length > 0">
    <div class="card-header">
      <h5 class="mb-0">Generated Files</h5>
    </div>
    <div class="card-body">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>Select</th>
            <th>File Name</th>
            <th>Created At</th>
            <th>Zip Status</th>
            <th>No of files </th>
            <th>Upload Status</th>
            <th>Verify Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let file of generatedFiles">
            <td>
              <input type="checkbox" [(ngModel)]="file.selected" (change)="onGeneratedSelectionChange()" />
            </td>
            <td>{{ file.fileName }}</td>
            <td>{{ file.createdAt | date:'short' }}</td>
            <td>{{ file.zipStatus || 'Not created yet' }}</td>
            <td>{{ file.fileCount || '-'}}</td>
            <td>{{ file.userFriendlyPostResponse || 'Not submitted yet' }}</td>
            <td>{{ file.userFriendlyCheckResponse || 'Not verified yet' }}</td>
            <td>
              <ng-container *ngIf="!file.ackId; else checkStatusButtons" [ngSwitch]="file.status">
                <button *ngSwitchCase="'idle'" (click)="submitFile(file)" class="btn btn-primary btn-sm">
                  Submit
                </button>
                <button *ngSwitchCase="'submitting'" class="btn btn-warning btn-sm"
                  [ngStyle]="{'background-color': '#77BFBF', 'border-color': '#e6b800'}" disabled>
                  <span class="spinner-border spinner-border-sm me-1"></span> Submitting...
                </button>

                <button *ngSwitchCase="'submitted'" class="btn btn-success btn-sm" disabled>
                  Submitted
                </button>
                <button *ngSwitchCase="'error'" class="btn btn-danger btn-sm" (click)="submitFile(file)">
                  Retry Submit
                </button>
              </ng-container>

              <ng-template #checkStatusButtons>
                <ng-container [ngSwitch]="file.checkStatusState">
                  <button *ngSwitchCase="'idle'" (click)="checkStatus(file)" class="btn btn-info btn-sm ms-2">
                    Check Status
                  </button>
                  <button *ngSwitchCase="'submitting'" class="btn btn-warning btn-sm"
                  [ngStyle]="{'background-color': '#77BFBF', 'border-color': '#e6b800'}" disabled>
                  <span class="spinner-border spinner-border-sm me-1"></span> checking...
                </button>
                  <button *ngSwitchCase="'checked'" class="btn btn-success btn-sm ms-2" disabled>
                    Checked
                  </button>
                  <button *ngSwitchCase="'error'" class="btn btn-danger btn-sm ms-2" (click)="checkStatus(file)">
                    Retry Check
                  </button>
                </ng-container>
              </ng-template>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="generatedFiles.length === 0" class="text-center text-muted py-4">
    No generated files found.
  </div>
</div> -->




<div class="container p-4">
  <!-- Search Section -->
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="position-relative">
        <div class="input-group">
          <input [(ngModel)]="searchQuery"
                 (input)="onSearchInput()"
                 class="form-control"
                 placeholder="Search..."
                 [disabled]="loading" />
          <button (click)="searchItems()" class="btn btn-primary">
            <span *ngIf="loading" class="spinner-border spinner-border-sm me-1"></span>
            Search
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Action Buttons -->
  <div class="mb-4">
    <div class="row">
      <!-- Add to Cart -->
      <div class="col-md-4">
        <button class="btn btn-secondary mb-3 w-100"
                (click)="addToCart()"
                [disabled]="selectedSearchFiles.length === 0">
          Add to Cart ({{ selectedSearchFiles.length }})
        </button>
      </div>

      <!-- Generate Files -->
      <div class="col-md-4">
        <button (click)="generateFiles()"
                [disabled]="generating || selectedSearchFiles.length === 0"
                class="btn btn-success mb-3 w-100">
          <span *ngIf="generating" class="spinner-border spinner-border-sm me-1"></span>
          {{ generating ? 'Generating...' : 'Generate Files' }}
        </button>
      </div>

      <!-- Post All Files -->
      <div class="col-md-4">
        <button (click)="submitAllFiles()"
                [disabled]="!selectedGeneratedFiles.length || submitting"
                class="btn btn-primary mb-3 w-100">
          <span *ngIf="submitting" class="spinner-border spinner-border-sm me-1"></span>
          {{ submitting ? 'Submitting...' : 'Post All Files' }}
        </button>
      </div>
    </div>
  </div>

  <!-- Search Results Table -->
  <div class="card" *ngIf="searchResults.length > 0">
    <div class="card-header">
      <h5 class="mb-0">Search Results</h5>
    </div>
    <div class="card-body p-0">
      <table class="table table-striped table-hover mb-0">
        <thead>
          <tr>
            <th>Select</th>
            <th>CINO Number</th>
            <th>File Name</th>
            <th>Created At</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let file of searchResults">
            <td>
              <input type="checkbox" [(ngModel)]="file.selected" (change)="onSearchSelectionChange()" />
            </td>
            <td>{{ file.cino }}</td>
            <td>{{ file.fileName }}</td>
            <td>{{ file.createdAt | date:'short' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- No search results -->
  <div *ngIf="searchResults.length === 0 && searchQuery" class="text-center text-muted py-4">
    No records found for "{{ searchQuery }}".
  </div>

  <!-- Generated Files Table -->
  <div class="card" *ngIf="generatedFiles.length > 0">
    <div class="card-header">
      <h5 class="mb-0">Generated Files</h5>
    </div>
    <div class="card-body p-0">
      <table class="table table-striped table-hover mb-0">
        <thead>
          <tr>
            <th>Select</th>
            <th>File Name</th>
            <th>Created At</th>
            <th>Zip Status</th>
            <th>No. of Files</th>
            <th>Upload Status</th>
            <th>Verify Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let file of generatedFiles">
            <td>
              <input type="checkbox" [(ngModel)]="file.selected" (change)="onGeneratedSelectionChange()" />
            </td>
            <td>{{ file.fileName }}</td>
            <td>{{ file.createdAt | date:'short' }}</td>
            <td>{{ file.zipStatus || 'Not created yet' }}</td>
            <td>{{ file.fileCount || '-' }}</td>
            <td>{{ file.userFriendlyPostResponse || 'Not submitted yet' }}</td>
            <td>{{ file.userFriendlyCheckResponse || 'Not verified yet' }}</td>
            <td>
              <!-- Show Submit if no ackId -->
              <ng-container *ngIf="!file.ackId; else checkStatusButtons" [ngSwitch]="file.status">
                <button *ngSwitchCase="'idle'" (click)="submitFile(file)" class="btn btn-primary btn-sm">
                  Submit
                </button>
                <button *ngSwitchCase="'submitting'" class="btn btn-warning btn-sm"
                        [ngStyle]="{'background-color': '#77BFBF', 'border-color': '#5aa0a0'}"
                        disabled>
                  <span class="spinner-border spinner-border-sm me-1"></span> Submitting...
                </button>
                <button *ngSwitchCase="'submitted'" class="btn btn-success btn-sm" disabled>
                  Submitted
                </button>
                <button *ngSwitchCase="'error'" class="btn btn-danger btn-sm" (click)="submitFile(file)">
                  Retry Submit
                </button>
              </ng-container>

              <!-- Show Check Status if ackId exists -->
              <ng-template #checkStatusButtons>
                <ng-container [ngSwitch]="file.checkStatusState">
                  <button *ngSwitchCase="'idle'" (click)="checkStatus(file)" class="btn btn-info btn-sm">
                    Check Status
                  </button>
                  <button *ngSwitchCase="'checking'" class="btn btn-warning btn-sm"
                          [ngStyle]="{'background-color': '#77BFBF', 'border-color': '#5aa0a0'}"
                          disabled>
                    <span class="spinner-border spinner-border-sm me-1"></span> Checking...
                  </button>
                  <button *ngSwitchCase="'checked'" class="btn btn-success btn-sm" disabled>
                    Checked
                  </button>
                  <button *ngSwitchCase="'error'" class="btn btn-danger btn-sm" (click)="checkStatus(file)">
                    Retry Check
                  </button>
                </ng-container>
              </ng-template>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div *ngIf="generatedFiles.length === 0" class="text-center text-muted py-4">
    No generated files found.
  </div>
</div>
