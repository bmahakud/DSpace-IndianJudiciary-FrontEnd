"use strict";(self.webpackChunkdspace_angular=self.webpackChunkdspace_angular||[]).push([[9050],{9050:(v,u,i)=>{i.r(u),i.d(u,{AdminAuditModule:()=>M});var o=i(60177),a=i(7901),d=i(21626),l=i(10887),t=i(54438);let h=(()=>{class n{constructor(e){this.http=e,this.private="/api/audit"}getAllUsers(){return this.http.get(`${l.$}/server/api/audit/users`)}getAuditLogsByUser(e){const s=(new d.Nl).set("userId",e);return this.http.get(`${l.$}/server/api/audit/user`,{params:s})}static{this.\u0275fac=function(s){return new(s||n)(t.KVO(d.Qq))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function g(n,c){if(1&n){const e=t.RV6();t.j41(0,"tr",2),t.bIt("click",function(){const r=t.eBV(e).$implicit,j=t.XpG();return t.Njj(j.goToDetails(r.userId))}),t.j41(1,"td")(2,"a"),t.EFF(3),t.k0s()(),t.j41(4,"td"),t.EFF(5),t.nI1(6,"date"),t.k0s(),t.j41(7,"td"),t.EFF(8),t.nI1(9,"date"),t.k0s(),t.j41(10,"td"),t.EFF(11),t.k0s()()}if(2&n){const e=c.$implicit;t.R7$(3),t.JRh(e.email),t.R7$(2),t.JRh(t.i5U(6,4,e.loginTime,"short")),t.R7$(3),t.JRh(t.i5U(9,7,e.logoutTime,"short")),t.R7$(3),t.JRh(e.duration)}}function m(n,c){if(1&n&&(t.j41(0,"li"),t.EFF(1),t.k0s()),2&n){const e=c.$implicit;t.R7$(),t.JRh(e)}}function F(n,c){if(1&n&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"date"),t.k0s(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s(),t.j41(10,"td"),t.EFF(11),t.k0s()()),2&n){const e=c.$implicit;t.R7$(2),t.JRh(e.action),t.R7$(2),t.JRh(t.i5U(5,5,e.timestamp,"short")),t.R7$(3),t.JRh(e.objectId||"-"),t.R7$(2),t.JRh(e.ipAddress||"-"),t.R7$(2),t.JRh(e.userAgent||"-")}}const f=[{path:"",component:(()=>{class n{constructor(e,s){this.router=e,this.auditService=s,this.users=[]}ngOnInit(){this.auditService.getAllUsers().subscribe({next:e=>{this.users=e||[]},error:e=>{console.error("Error fetching users:",e)}})}goToDetails(e){this.router.navigate(["/user-audit/user",e])}static{this.\u0275fac=function(s){return new(s||n)(t.rXU(a.Ix),t.rXU(h))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-audit-user-list"]],decls:16,vars:1,consts:[[1,"user-list-container"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(s,r){1&s&&(t.j41(0,"div",0)(1,"h2"),t.EFF(2,"User Audit Log Summary"),t.k0s(),t.j41(3,"table")(4,"thead")(5,"tr")(6,"th"),t.EFF(7,"Email"),t.k0s(),t.j41(8,"th"),t.EFF(9,"Last Login"),t.k0s(),t.j41(10,"th"),t.EFF(11,"Last Logout"),t.k0s(),t.j41(12,"th"),t.EFF(13,"Duration"),t.k0s()()(),t.j41(14,"tbody"),t.DNE(15,g,12,10,"tr",1),t.k0s()()()),2&s&&(t.R7$(15),t.Y8G("ngForOf",r.users))},dependencies:[o.Sq,o.vh],styles:[".user-list-container[_ngcontent-%COMP%]{padding:24px}.user-list-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;cursor:pointer}.user-list-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .user-list-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;border:1px solid #ccc;text-align:left}.user-list-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.user-list-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:underline;color:#007bff}"]})}}return n})()},{path:"user/:userId",component:(()=>{class n{constructor(e,s){this.route=e,this.auditService=s,this.userId="",this.userLogs=[],this.uniqueDevices=[]}ngOnInit(){const e=this.route.snapshot.paramMap.get("userId");e?(this.userId=e,this.fetchUserLogs(this.userId)):console.error("User ID param is missing")}fetchUserLogs(e){this.auditService.getAuditLogsByUser(e).subscribe({next:s=>{this.userLogs=s,this.uniqueDevices=[...new Set(s.map(r=>r.userAgent))]},error:s=>{console.error("Error fetching audit logs:",s)}})}static{this.\u0275fac=function(s){return new(s||n)(t.rXU(a.nX),t.rXU(h))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-audit-user-details"]],decls:24,vars:2,consts:[[1,"user-details-container"],[1,"summary-box"],[4,"ngFor","ngForOf"]],template:function(s,r){1&s&&(t.j41(0,"div",0)(1,"div",1)(2,"p")(3,"strong"),t.EFF(4,"Devices Used:"),t.k0s()(),t.j41(5,"ul"),t.DNE(6,m,2,1,"li",2),t.k0s()(),t.j41(7,"h3"),t.EFF(8,"Action Timeline"),t.k0s(),t.j41(9,"table")(10,"thead")(11,"tr")(12,"th"),t.EFF(13,"Action"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Timestamp"),t.k0s(),t.j41(16,"th"),t.EFF(17,"Object"),t.k0s(),t.j41(18,"th"),t.EFF(19,"IP"),t.k0s(),t.j41(20,"th"),t.EFF(21,"Device"),t.k0s()()(),t.j41(22,"tbody"),t.DNE(23,F,12,8,"tr",2),t.k0s()()()),2&s&&(t.R7$(6),t.Y8G("ngForOf",r.uniqueDevices),t.R7$(17),t.Y8G("ngForOf",r.userLogs))},dependencies:[o.Sq,o.vh],styles:[".user-details-container[_ngcontent-%COMP%]{padding:24px}.user-details-container[_ngcontent-%COMP%]   .summary-box[_ngcontent-%COMP%]{background:#f9f9f9;padding:12px;margin-bottom:20px;border-radius:4px}.user-details-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.user-details-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .user-details-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc}.user-details-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f5f5f5}"]})}}return n})()}];let C=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[a.iI.forChild(f),a.iI]})}}return n})();var O=i(89417);let M=(()=>{class n{static{this.\u0275fac=function(s){return new(s||n)}}static{this.\u0275mod=t.$C({type:n})}static{this.\u0275inj=t.G2t({imports:[o.MD,O.YN,C]})}}return n})()}}]);